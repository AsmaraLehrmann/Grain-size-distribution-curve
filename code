import os
import pandas as pd
import matplotlib.pyplot as plt
import matplotlib.cm as cm
import numpy as np
import cmcrameri

# Path to the folder containing CSV files
folder_path = "/Users/alehrmann/Documents/Research_files/West_Antarctica/Amundsen_Sea/Dotson/grainsize/NBP2202_KC06/NBP2202_KC06_formatted"

# Initialize lists to store data from all files
um_all = []
indiv_perc_all = []
file_names = []  # Store file names for labels

# Iterate through all files in the folder
for filename in os.listdir(folder_path):
    if filename.endswith(".csv"):
        # Read the CSV file
        data = pd.read_csv(os.path.join(folder_path, filename))
        
        # Extract the columns of interest
        um = data["um"]
        indiv_perc = data["indiv perc"]
        
        # Append data to the lists
        um_all.append(um)
        indiv_perc_all.append(indiv_perc)
        file_names.append(filename)  # Store file name

# Sort file names alphabetically
file_names_sorted = sorted(file_names)

# Create a larger figure
plt.figure(figsize=(10, 6))  # Adjust width and height as needed

# Create a line plot for each file using cmcrameri's colormap
num_files = len(um_all)
color_palette = cmcrameri.cm.roma  # Using 'roma' colormap from cmcrameri
for i, (um, indiv_perc, filename) in enumerate(zip(um_all, indiv_perc_all, file_names)):
    color = color_palette(i / num_files)
    plt.plot(um, indiv_perc, alpha=0.8, color=color, label=filename)  # Add label for the file

plt.title('Distribution of "um" vs "indiv perc"')
plt.xlabel('Grain size (Âµm)')  # Updated x-axis label
plt.ylabel('wt %')  # Updated y-axis label
plt.grid(True)

# Set x-axis to be logarithmic
plt.xscale('log')

# Display legend outside the plot in alphabetical order
plt.legend([filename for filename in file_names_sorted], bbox_to_anchor=(1.05, 1), loc='upper left')

plt.tight_layout()  # Adjust layout to prevent overlap
plt.show()

#Save as .svg
plt.savefig('NBP2202KC06.svg', format='svg')
